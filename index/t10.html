<!DOCTYPE html>
<head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251" />
<link rel="stylesheet" type="text/css" media="all" href="content/styles.css" />
<title>Операции ввода с клавиатуры и вывода на экран в DOS приложениях.</title>
<link rel="shortcut icon" href="content/icon.ico" type="image/x-icon" />
</head>

<body class="body">
 <a name="up"></a>
 
 
 <!--шапка-->
 <div id="header">
    <div id="header-content">
		<p class="bonch"> Санкт-Петербургский государственный университет телекоммуникаций им. проф. М.А.Бонч-Бруевича<br>
	    <nobr style="color:#ff8000;">Программирование на Машинно-Ориентированных Языках</nobr>
	    </p>
		<a class="home" href="../index.html"><img title="На главную" src="content/home.png" ></a>
    <div id="main_menu">  
<!-- Главное Меню -->	  
<ul class="menu_mainmenu">
<li><a href="themes_3.html" >Теория (часть 1)</a>
<ul>
<li><a href="t1.html" >&diams;Регистры</a>
	<ul>
		<li><a href="t1.html#ron" >&diams;Регистры Общего Назначения</a></li>
		<li><a href="t1.html#ir" >&diams;Индексные Регистры</a></li>
		<li><a href="t1.html#rs" >&diams;Регистры Сегментов</a></li>
		<li><a href="t1.html#ru" >&diams;Регистры - Указатели</a></li>
		<li><a href="t1.html#ruk" >&diams;Регистр Указателя Команд</a></li>
		<li><a href="t1.html#rf" >&diams;Регистр Флагов</a></li>
	</ul>
</li>
<li><a href="t2.html">&diams;Сегменты, принцип сегментации</a></li>
<li><a href="t3.html">&diams;Стек</a></li>
<li><a href="t4.html" >&diams;Адресация</a>
	<ul>
		<li><a href="t4.html#ad" >&diams;Адресация данных</a></li>
		<li><a href="t4.html#ar" >&diams;Режимы адресации</a></li>
	</ul>
</li>
<li><a href="t5.html" >&diams;Организация программы</a>
	<ul>
		<li><a href="t5.html#ops" >&diams;Организация программы.Сегменты</a></li>
		<li><a href="t5.html#mp" >&diams;Модели памяти и упрощенные директивы определения сегментов</a></li>
		<li><a href="t5.html#dz" >&diams;Директивы задания набора допустимых команд</a></li>
	</ul>
</li>		
<li><a href="t6.html">&diams;Структура программы на языке Ассемблера</a>
	<ul>
		<li><a href="t6.html#st" >&diams;Структура программы на языке Ассемблера</a></li>
		<li><a href="t6.html#com" >&diams;Программа типа СОМ</a></li>
	</ul>
</li>
<li><a href="t7.html" >&diams;Инициализация и описание данных</a></li>
<li><a href="t8.html" >&diams;Арифметические команды</a>
	<ul style="top:-235px">
		<li><a href="t8.html#ks" >&diams;Команды сложения ADD, ADC, INC</a>
			<ul>
			<li><a href="t8.html#add" >&diams;ADD</a></li>
			<li><a href="t8.html#adc" >&diams;ADC</a></li>
			<li><a href="t8.html#inc" >&diams;INC</a></li>
			</ul></li>
		<li><a href="t8.html#kv" >&diams;Команды вычитания SUB, SBB, DEC и NEG</a>
		<ul>
			<li><a href="t8.html#kv" >&diams;SUB, SBB, DEC</a></li>
			<li><a href="t8.html#neg" >&diams;NEG</a></li>
		</ul></li>
		<li><a href="t8.html#ku" >&diams;Команды умножения MUL и IMUL</a>
		<ul>
			<li><a href="t8.html#mul" >&diams;MUL</a></li>
			<li><a href="t8.html#imul" >&diams;IMUL</a></li>
		</ul></li>
		<li><a href="t8.html#ubc" >&diams;Умножение больших чисел</a></li>
		<li><a href="t8.html#kd" >&diams;Команды деления DIV и IDIV</a></li>
		<li><a href="t8.html#pr" >&diams;Преобразование байта в слово и слова
		в двойное слово</a></li>
		<li><a href="t8.html#dbc" >&diams;Деление больших чисел</a></li>	
	</ul>
</li>
<li><a href="t9.html" >&diams;Команды передачи управления</a>
	<ul style="top:-215px">
		<li><a href="t9.html#jmp" >&diams;Команда безусловного перехода JMP</a></li>
		<li><a href="t9.html#usl" >&diams;Команды условной передачи управления</a></li>
		<li><a href="t9.html#znak" >&diams;Знаковые и беззнаковые данные</a></li>
		<li><a href="t9.html#bzd" >&diams;Переходы для беззнаковых данных</a></li>
		<li><a href="t9.html#zd" >&diams;Переходы для знаковых данных</a></li>
		<li><a href="t9.html#sp" >&diams;Специальные арифметические проверки</a></li>
	</ul>
</li>
<li><a href="t80.html" >&diams;Команды сдвигов</a></li>	
</ul>

 
<li><a href="themes_3.html" >Теория (часть 2)</a>
<ul>
<li><a href="t81.html">&diams;Команды логических операций</a></li>
<li><a href="t90.html">&diams;Команды циклов</a></li>
<li><a href="t91.html">&diams;Работа с подпрограммами</a></li>
<li><a href="t10.html" >&diams;Операции ввода с клавиатуры и вывода на экран в DOS приложениях</a>
	<ul>
		<li><a href="t10.html#output" >&diams;Вывод на экран средствами DOS</a></li>
		<li><a href="t10.html#input" >&diams;Ввод данных с клавиатуры</a></li>
		<li><a href="t10.html#str-name" >&diams;Ввод и вывод имен (строк)</a>
		<ul style="top:-82px"><li><a href="t10.html#str-out" >&diams;Вывод текста запроса</a></li>
			<li><a href="t10.html#str-in" >&diams;Ввод имени с клавиатуры</a></li>
			<li><a href="t10.html#str-zv" >&diams;Установка звукового сигнала и ограничителя '$'</a></li>
			<li><a href="t10.html#str-centr" >&diams;Центрирование и вывод имени на экран</a></li>
			<li><a href="t10.html#clear" >&diams;Очистить экран</a></li>
			<li><a href="t10.html#str" >&diams;Установка курсора (строка/столбец)</a></li>
		</ul></li>
		<li><a href="t10.html#pr" >&diams;Преобразование строки в число и числа в строку</a>
		<ul><li><a href="t10.html#asc" >&diams;Преобразование ASCII-формата в двоичный формат</a></li>
		    <li><a href="t10.html#toAsc" >&diams;Преобразование двоичного формата в ASCII-формат</a></li>
		</ul></li>	</ul>
</li>
<li><a href="t10-2.html" >&diams;Программирование в UNIX</a>
	<ul style="top:-50px">
		<li><a href="t10-2.html#pr_unix" >&diams;Программирование в LINUX (первый пример)</a></li>
		<li><a href="t10-2.html#make" >&diams;Утилита make</a></li>
		<li><a href="t10-2.html#perem" >&diams;Переменные</a></li>
		<li><a href="t10-2.html#output" >&diams;Вывод на экран через INT 80H</a></li>
		<li><a href="t10-2.html#printf" >&diams;Вывод с помощью printf</a></li>
		<li><a href="t10-2.html#vizov" >&diams;Вызов функций scanf и printf из Nasm</a></li>
		<li><a href="t10-2.html#arifm" >&diams;Арифметические операции  в формате ASCII</a>
		<ul style="top:-137px">
		<li><a href="t10-2.html#sloz" >&diams;Сложение в ASCII-формате</a></li>
		<li><a href="t10-2.html#vic" >&diams;Вычитание в ASCII-формате</a></li>
		<li><a href="t10-2.html#umn" >&diams;Умножение в ASCII-формате</a></li>
		<li><a href="t10-2.html#del" >&diams;Деление в ASCII-формате</a></li>
		<li><a href="t10-2.html#bcd" >&diams;Двоично-десятичный формат (SCD)</a></li>
	</ul></li></ul>
</li>	
<li><a href="t13.html">&diams;EXE и COM форматы</a>
	<ul style="top:-171px">
		<li><a href="t13.html#rp" >&diams;Распределение программы в памяти</a></li>
		<li><a href="t13.html#exe+com" >&diams;EXE- и COM-программы</a></li>
		<li><a>&diams;EXE</a>
		<ul><li><a href="t13.html#exe" >&diams;Заголовок EXE-файла</a></li>
		<li><a href="t13.html#exe-str" >&diams;Описание структуры заголовка EXE 
		файла и таблицы расположения сегментов</a></li>
		</ul></li>
		<li><a href="t13.html#pzpp" >&diams;Процесс загрузки программ в память</a></li>
		<li><a href="t13.html#prps" >&diams;Префикс программного сегмента</a></li>
		<li><a href="t13.html#str-psp" >&diams;Структура PSP</a></li>
		<li><a href="t13.html#exe-pr" >&diams;EXE-программы</a></li>
		<li><a href="t13.html#com-pr" >&diams;COM-программы</a></li>
		<li><a href="t13.html#exit-pr" >&diams;Выход из программы</a></li>
	</ul>
</li>
<li><a href="t11.html" >&diams;Обработка массивов</a>
	<ul style="top:-36px">
		<li><a href="t11.html#str" >&diams;Обработка строк</a></li>
		<li><a href="t11.html#m1" >&diams;Обработка одномерных массивов</a></li>
		<li><a href="t11.html#m2" >&diams;Двумерные массивы</a></li>
		</ul>
</li>	
<li><a href="t12.html" >&diams;Математический сопроцессор</a>
	<ul style="top:-190px">
		<li><a href="t12.html#ms" >&diams;Математический сопроцессор</a></li>
		<li><a href="t12.html#och" >&diams;Особые числав</a></li>
		<li><a href="t12.html#reg" >&diams;Регистры</a></li>
		<li><a href="t12.html#rd" >&diams;Регистры данных</a></li>
		<li><a href="t12.html#sc" >&diams;Система команд</a></li>
		<li><a href="t12.html#uoc" >&diams;Условные обозначения для команд базового сопроцессора</a></li>
		<li><a>&diams;Команды</a><ul>
			<li><a href="t12.html#cpd" >&diams;Команды пересылки данных</a></li>
			<li><a href="t12.html#czk" >&diams;Команды загрузки констант</a></li>
			<li><a href="t12.html#ak" >&diams;Арифметические команды</a></li>
			<li><a href="t12.html#sak" >&diams;Специальные арифметические команды</a></li>
		</ul></li></ul>
</li>	
<li><a href="t14.html">&diams;Машинные коды</a>
	<ul style="top:-140px">
		<li><a href="t14.html#mk" >&diams;Машинные коды</a></li>
		<li><a href="t14.html#bko" >&diams;Байт кода операции</a></li>
		<li><a href="t14.html#bsa" >&diams;Байт способа адресации</a></li>
		<li><a href="t14.html#ra" >&diams;Режимы адресации</a></li>
		<li><a href="t14.html#pras" >&diams;Примеры ассемблирования</a></li>
	</ul>
</li>		
</ul>


<li><a href="themes_1.html" >Практикум</a>
<ul>
<li><a href="l1.html" > &diams; Лабораторная Работа №1 </a></li>
<li><a href="l2.html" > &diams; Лабораторная Работа №2</a></li>
<li><a href="l3.html" > &diams; Лабораторная Работа №3</a></li>
<li><a href="l4.html" > &diams; Лабораторная Работа №4</a></li>
<li><a href="l5.html" > &diams; Лабораторная Работа №5</a></li>
</ul>  </ul>
<!-- Главное Меню -- END -->
</div>
</div>
</div>
  
  
 <!-- страничка-->
<div id="width-page-00">
    <div id="page-00" style=" overflow:  hidden; height:  100%;">
		<marquee loop="-1" scrollamount="1" behavior="alternate" direction="up" height="100%">
		О п е р а ц и и<p> </p>в в о д а<p></p>/<p></p>в ы в о д а 
		</marquee>
	</div>
</div>
 
   <div id="width-page">
      <div id="page">
		 <div id="page_content">
            <div class="themes"> 
	<a name="output"></a>
	<h2>ВЫВОД НА ЭКРАН СРЕДСТВАМИ DOS.</h2>
	<p class="stress">	 </p> 
	<p class="text">
		Вывод на экран средствами <b>DOS</b>  осуществляет <b>09</b> функция
		<code>INT  21H DOS</code>. Номер функции указывается  в регистре  <b>AH</b>.
		Адрес выводимой строки в <b>DS:DX</b>.  В  процессе выполнения операции  
		конец  сообщения  определяется  по  oграничителю  <b>($)</b>.
		<table>
		<tr>
			<td width="333px"><code>PRMP     DB   ‘Строка','$'</CODE></td>
			<td></td>
		</tr>
		<tr>
			<td><code>.</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>.</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV  AH,09</code></td>
			<td><comment> ; Запрос вывода на экран</comment></td>
		</tr>
		<tr>
			<td><code>LEA  DX,PRMP</code></td>
			<td><comment> ; Загрузка адреса сообщ.</comment></td>
		</tr>
		<tr>
			<td><code>INT  21H</code></td>
			<td><comment> ; Вызов DOS</comment></td>
		</tr>
	</table></p>
	<p class="text">
	Знак ограничителя <b>'$'</b> можно кодировать  непосредственно  после  cимвольной 
	строки (как показано в примере), внутри строки: <b>'Имя покупателя?$'</b>, или  
	в следующем операторе <b>DB '$'</b>.  Используя данную операцию, нельзя вывести 
	на экран  символ  доллара  <b>"$"</b>.  Кроме  того,  если  знак    доллара  
	будет отсутствовать в конце строки, то на экран будут выводиться все последующие 
	символы, пока знак <b>"$"</b> не встретиться в памяти. <br><br>
    Команда <b>LEA</b> загружает адрес области <b>PRMP</b> в регистр <b>DX </b>для передачи
	в <b>DOS</b> адреса выводимой информации. Адрес поля <b>PRMP</b>, загружаемый в 
	<b>DX</b> по команде <b>LEA</b>, является oтносительным, поэтому  для  вычисления
	абсолютного адреса данных <b>DOS</b> складывает значения регистров <b>DS</b> и <b>DX (DS:DX)</b>.	
	</p>
	<a name="input"></a>
	<h2>ВВОД ДАННЫХ С КЛАВИАТУРЫ.</h2>
	<p class="stress">	 </p> 
	<p class="text">
	Для ввода с клавиатуры используется функция <code>0AH INT 21H</code>. Она требует  наличия
	cписка параметров, содержащего поля, которые необходимы  при  выполнении  команды <b>INT</b>. 
	<ul class="text"><li>должна  быть  определена  максимальная  длина  вводимого текста;</li><li>
    должно  быть  определенное поле, куда команда возвращает действительную  длину  
	введенного  текста  в байтах. </li><li>
    должно быть зарезервировано в памяти место для вводимой строки</li></ul>
	<p><p class="text">
	Ниже приведен пример,  в  котором  определен  список  параметров  для области ввода.<br>
	<b>LABEL</b> представляет собой директиву с атрибутом <b>BYTE</b>. Первый байт содержит 
	максимальную длину вводимых данных.  Второй байт  необходим  <b>DOS</b>  для занесения
	в него действительного числа введенных символов.  Третьим  байтом  начинается  поле,  
	которое   будет   содержать введенные символы.
	<table>
		<tr>
			<td width="333px"><code>NAMEPAR     LABEL     BYTE</code></td>
			<td><comment> ; Список параметров:</comment></td>
		</tr>
		<tr>
			<td><code>   MAXLEN        DB        20</code></td>
			<td><comment> ; Максимальная длина</comment></td>
		</tr>
		<tr>
			<td>  <code>  ACTLEN         DB        ?</code> </td>
			<td><comment> ; Реальная длина </comment></td>
		</tr>
		<tr>
			<td><code> NAMEFLD      DB        20 DUP (' ')</code></td>
			<td><comment> ; Введенные символы</comment></td>
		</tr>
	</table></p>
	<p class="text">
	Так как в списке параметров директива <b>LABEL</b>  не  занимает  места,  то 
	<b>NAMEPAR</b> и <b>MAXLEN</b> указывают на один и тот же aдрес  памяти. Для
	запроса на ввод необходимо поместить в регистр <b>AH</b> номер функции <b>-10</b> 
	(шест.  <b>0AH</b>),  загрузить  адрес  списка  параметров  (<b>NAMEPAR</b>  в  
	нашем примере) в регистр <b>DX</b> и выполнить <code>INT 21H</code>:
	<table>
		<tr>
			<td width="333px"><code>MOV  AH,0AH </code></td>
			<td><comment> ; Запрос функции ввода</comment></td>
		</tr>
		<tr>
			<td><code>LEA  DX,NAMEPAR</code> </td>
			<td><comment> ; Aдреса списка параметров</comment></td>
		</tr>
		<tr>
			<td><code>INT  21H</code></td>
			<td><comment> ; Вызвать DOS</comment></td>
		</tr>
	</table>  </p>
	<p class="text">
	Команда <b>INT</b> ожидает пока пользователь не введет с  клавиатуры  текст,
	проверяя  при  этом,  чтобы  число  введенных  cимволов   <b> не    превышало</b>
	максимального  значения,  указанного  в  списке  параметров  (<b>20</b>  в  нашем 
	случае).  Для указания конца ввода пользователь нажимает клавишу  <b>Return</b>.<br>
	Код этой клавиши (шест. <b>0D</b>) также заносится в поле ввода (<b>NAMEFLD</b>
	в  нашем примере).  Если, например, пользователь ввел имя <b>BROWN (Return)</b>, то cписок
	параметров будет содержать информацию:<br>
	<center><table border="1" cellspacing="0" cellpadding="10" width="95%" class="text">
		<tr>
			<td>дес. :</td>
			<td>20</td>
			<td>5</td>
			<td>B</td>
			<td>R</td>
			<td>O</td>
			<td>W</td>
			<td>N</td>
			<td>#</td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td> ... </td>
		</tr>
		<tr>
			<td>шест. :</td>
			<td>14</td>
			<td>05</td>
			<td>42</td>
			<td>52</td>
			<td>4F</td>
			<td>57</td>
			<td>4E</td>
			<td>0D</td>
			<td>20</td>
			<td>20</td>
			<td>20</td>
			<td>20</td>
			<td> ... </td>
		</tr>
	</table></center></p>
	<p class="text">
	Во второй байт списка параметров (<b>ACTLEN</b>  в  нашем  примере)  команда
	заносит длину введенного имени  -  <b>05</b>.  Код  <b>Return</b>  находится  по  адресу
	<b>NAMEFLD +5</b>. Символ <b>#</b> использован здесь для индикации конца данных, так как
	<b>шест. 0D</b> не имеет отображаемого символа. Поскольку максимальная длина в <b>20</b>
	символов включает шест.<b>0D</b>, то действительная длина вводимого текста  может
	быть только <b>19</b> символов.<br>
	</p>
	
	<a name="str-name"></a>
	<h2>ПРИМЕР: ВВОД И ВЫВОД ИМЕН (СТРОК).</h2>
	<p class="stress">	 </p> 
	<p class="text">
	<b>EXE</b>-программа  запрашивает ввод имени (строки), затем отображает 
	в середине экрана введенное имя (строку)  и  включает  звуковой  сигнал.<br>
	Программа продолжает запрашивать и отображать имена, пока пользователь  не
	нажмет <b>Return</b> в ответ на  очередной  запрос. <br><br> 
	Рассмотрим  ситуацию,  когда пользователь ввел имя (строку) <b>TED SMITH</b>:<br>
     &nbsp &nbsp &nbsp <b><big>1</big></b>. Разделим длину имени <b>09</b> на 
	 <b>2</b> получим <b>4</b>;<br>
      &nbsp &nbsp &nbsp <b><big>2</big></b>. Вычтем это значение из <b>40</b>,
	  получим <b>36</b>.<br><br>
	Команда <b>SHR</b> в процедуре <b>E10CENT</b> сдвигает длину <b>09</b> на oдин 
	бит вправо, выполняя таким образом деление на <b>2</b>. Значение  бит  
	<b>00001001</b>  переходит  в <b>00000100</b>. Команда <b>NEG</b>  меняет
	знак  <b>+4</b>  на  <b>-4</b>.  Команда  <b>ADD</b>  прибавляет значение
	<b>40</b>, получая в регистре <b>DL</b> номер  начального  столбца  -  <b>36</b>.
	При установке курсора на строку <b>12</b> и столбец <b>36</b> имя будет выведено
	на экран  в следующем виде:
	<table class="text" align ="center">
		<tr>
			<td>Строка 12:</td>
			<td>TED</td>
			<td>SMITH</td>
		</tr>
		<tr>
			<td></td>
			<td>|</td>
			<td>|</td>
		</tr>
		<tr>
			<td>Столбец:</td>
			<td>36</td>
			<td>40</td>
		</tr>
	</table></p>
	<p class="text">
     В процедуре <b>E10CODE</b> имеется  команда,  которая устанавливает
	 cимвол звукового сигнала (<b>07</b>) в области ввода непосредственно
	 после имени (строки):<br><br><code>MOV  NAMEFLD[BX],07</code><br><br>
	Предшествующая команда устанавливает в регистре <b>BX</b> значение 
	длины,  и команда <b>MOV</b> затем, комбинируя длину в регистре <b>BX</b>
	и  адрес  поля  <b>NAMEFLD</b> пересылает код <b>07</b>. Например, при 
	длине имени <b>05</b> код <b>07</b>  будет  помещен  по адресу 
	<b>NAMEFLD+05</b> (замещая значение  кода  <b>Return</b>).  Последняя
	команда  в процедуре <b>E10CODE</b> устанавливает ограничитель  <b>"$"</b>
	после  кода  <b>07</b>.  Таким образом, когда процедура <b>F10CENT</b> 
	выводит на  экран  имя (строку) ,  то  генериpуется также звуковой сигнал.
	<table>
		<tr>
			<td colspan="2"><comment>; --------------------------------------------------------</comment>
			<br><code>STSCKSG SEGMENT PARA STACK 'Stack'<br>
			DW      32 DUP(?)
			<br>STACKSG ENDS</code><br>
			<comment>; --------------------------------------------------------</comment>
			<br><code>DATASG  SEGMENT PARA 'Data'</code></td>
			<td></td>
		</tr>
		<tr>
			<td width="333px"><code>NAMEPAR LABEL   BYTE </code></td>
			<td><comment> ; Имя списка параметров:</comment></td>
		</tr>
		<tr>
			<td><code>MAXNLEN DB      20</code></td>
			<td><comment>; макс. длина имени</comment></td>
		</tr>
		<tr>
			<td><code>NAMELEN DB      ?</code></td>
			<td><comment>; число введенных символов</comment></td>
		</tr>
		<tr>
			<td><code>NAMEFLD DB      20 DUP(' '),'$'</code></td>
			<td><comment>; имя и ограничитель для вывода на экран</comment></td>
		</tr>
		<tr>
			<td colspan="2"><code>PROMPT  DB      'Name? ', '$'<br>
			DATASG  ENDS<br>
			CODESG  SEGMENT PARA 'Code"
			<br>BEGIN   PROC    FAR
			<br>ASSUME  CS:CODESG,DS:DATASG,SS:STACKSG,ES:DATASG
			<br>PUSH    DS
			<br>SUB      AX,AX
			<br>PASH    AX
			<br>MOV     AX,DATASC
			<br>MOV     DS,AX
			<br>MOV     ES,AX</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>CALL    Q10CLR</code></td>
			<td><comment>; Очистить экран</comment></td>
		</tr>
		<tr>
			<td><code>A20LOOP:</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV     DX,0000</code></td>
			<td><comment>; Установить курсор в 00,00</comment></td>
		</tr>
		<tr>
			<td><code>CALL    Q20CURS</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>CALL    B10PRMP</code></td>
			<td><comment>; Выдать текст запроса</comment></td>
		</tr>
		<tr>
			<td><code>CALL    D10INPT</code></td>
			<td><comment>; Ввести имя</comment></td>
		</tr>
		<tr>
			<td><code>CALL    Q10CLR</code></td>
			<td><comment>; Очистить экран</comment></td>
		</tr>
		<tr>
			<td><code>CMP     NAMELEN,00</code></td>
			<td><comment>; Имя введено?</comment></td>
		</tr>
		<tr>
			<td><code>JE      A30</code></td>
			<td><comment>; нет - выйти</comment></td>
		</tr>
		<tr>
			<td><code>CALL    E10CODE</code></td>
			<td><comment>; Установить звуковой сигнал и ограничитель '$'</comment></td>
		</tr>
		<tr>
			<td><code>CALL    F10CENT</code></td>
			<td><comment>; Центрирование и вывод</comment></td>
		</tr>
		<tr>
			<td><code>JMP     A20LOOP<br>A30:</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>RET </code></td>
			<td><comment>; Вернуться в DOS</comment></td>
		</tr>
		<tr>
			<td><code>BEGIN   ENDP</code></td>
			<td></td>
		</tr>
	</table></p>
	<a name="str-out"></a>
	<h2>Вывод текста запроса:</h2>
	<p class="stress">	 </p> 
	<table>
		<tr>
			<td width="333px"><code>B10PRMP PROC    NEAR</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV     AH,09 </code></td>
			<td><comment>; Функция вывода на экран</comment></td>
		</tr>
		<tr>
			<td><code>LEA     DX,PROMPT
			<br>INT     21H
			<br>RET
			<br>B10PRMP ENDP</code></td>
			<td></td>
		</tr>
	</table>
	<a name="str-in"></a>
	<h2>Ввод имени с клавиатуры:</h2>
	<p class="stress">	 </p> 
	<table>
		<tr>
			<td width="333px"><code>D10INPT PROC    NEAR</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV     AH,0AH</code></td>
			<td><comment>; Функция ввода</comment></td>
		</tr>
		<tr>
			<td><code>LEA     DX,NAMEPAR
			<br>INT     21H
			<br>RET
			<br>D10INPT ENDP</code></td>
			<td></td>
		</tr>
	</table>
	<a name="str-zv"></a>
	<h2>Установка звукового сигнала и ограничителя '$':</h2>
	<p class="stress">	 </p>
	<table>
		<tr>
			<td width="333px"><code>E10CODE PROC   NEAR</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV    BH,00</code> </td>
			<td><comment>; Замена символа Return (0D)</comment></td>
		</tr>
		<tr>
			<td><code>MOV    BL,NAMELEN </code></td>
			<td><comment>; на зв. сигнал (07)</comment></td>
		</tr>
		<tr>
			<td><code>MOV    NAMEFLD[BX],07</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV    NAMEFLD[BX+1],'$' </code></td>
			<td><comment>; Установить ограничитель</comment></td>
		</tr>
		<tr>
			<td><code>RET<br>
			E10CODE ENDP</code></td>
			<td></td>
		</tr>
	</table>
	<a name="str-centr"></a>
	<h2>Центрирование и вывод имени на экран:</h2>
	<p class="stress">	 </p>
	<table>
		<tr>
			<td width="333px"><code>F10CENT PROC   NEAR</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV    DL,NAMELEN  </code></td>
			<td><comment>; Определение столбца:</comment></td>
		</tr>
		<tr>
			<td><code>SHR    DL,1 </code> </td>
			<td><comment>; разделить длину на 2,</comment></td>
		</tr>
		<tr>
			<td><code>NEG    DL</code> </td>
			<td><comment>; поменять знак,</comment></td>
		</tr>
		<tr>
			<td><code>ADD    DL,40 </code></td>
			<td><comment>; прибавить 40</comment></td>
		</tr>
		<tr>
			<td><code>MOV    DH,12</code></td>
			<td><comment>; Центральная строка</comment></td>
		</tr>
		<tr>
			<td><code>CALL   Q20CURS </code></td>
			<td><comment>; Установить курсор</comment></td>
		</tr>
		<tr>
			<td><code>MOV    AH,09</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>LEA    DX,NAMEFLD</code></td>
			<td><comment>; Вывести имя на экран</comment></td>
		</tr>
		<tr>
			<td><code>INT    21H
			<br>RET
			<br>F10CENT ENDP</code></td>
			<td></td>
		</tr>
	</table>
	<a name="clear"></a>
	<h2>Очистить экран:</h2>
	<p class="stress">	 </p>
	<table>
		<tr>
			<td width="333px"><code>Q10CLR  PROC   NEAR</code></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MOV    AX,0600H </code></td>
			<td><comment>; Функция прокрутки экрана</comment></td>
		</tr>
		<tr>
			<td><code>MOV    BH,30 </code></td>
			<td><comment>; Цвет (07 для ч/б)</comment></td>
		</tr>
		<tr>
			<td><code>MOV    CX,0000 </code></td>
			<td><comment>; От 00,00</comment></td>
		</tr>
		<tr>
			<td><code>MOV    DX,184FH</code> </td>
			<td><comment>; До 24,79</comment></td>
		</tr>
		<tr>
			<td><code>INT    10H </code></td>
			<td><comment>; Вызов BIOS</comment></td>
		</tr>
		<tr>
			<td><code>RET<br>Q10CLR</code></td>
			<td></td>
		</tr>
	</table>
	<a name="str"></a>
	<h2>Установка курсора (строка/столбец):</h2>
	<p class="stress">	 </p>
	<table>
		<tr>
			<td width="333px"><code>Q20CURS PROC   NEAR </code></td>
			<td><comment>; DX уже установлен</comment></td>
		</tr>
		<tr>
			<td><code>MOV    AH,02 </code></td>
			<td><comment>; Функция установки курсора</comment></td>
		</tr>
		<tr>
			<td><code>MOV    BH,00 </code></td>
			<td><comment>; Страница #0</comment></td>
		</tr>
		<tr>
			<td><code>INT      10H </code> </td>
			<td><comment>; Вызов BIOS</comment></td>
		</tr>
		<tr>
			<td><code>RET<br>Q20CURS ENDP<br>
			<br>CODESG  ENDS<br>END    BEGIN</code></td>
			<td></td>
		</tr>
		
	</table>


	<a name="pr"></a>
	<h2>Преобразование строки в число и числа в строку.</h2>
	<p class="stress">	 </p> 
	<p class="text">
	Данные, вводимые с клавиатуры,  имеют <b>ASCII</b>-формат,  например,  
	буквы <b>SAM</b>  имеют  в памяти шестнадцатеричное представление <b>53414D</b>,  
	цифры <b>1234</b> - шест.<b>31323334</b>.  Во многих случаях формат алфавитных данных,
	например, имя человека или описание статьи,  не меняется в программе.  Но для 
	выполнения арифметических   операций   над   числовыми   значениями,    такими    
	как шест.<b>31323334</b>, требуется специальная обработка.
	</p>
	<a name="asc"></a>
	<h2>ПРЕОБРАЗОВАНИЕ ASCII-ФОРМАТА (строки) В ДВОИЧНЫЙ ФОРМАТ (число).</h2>
	<p class="stress">	 </p> 
	<p class="text">
	Для выполнения арифметических операций часто требуется  преобразование 
	их в  двоичный  формат.<br><br>
	Процедура преобразования заключается в следующем:<ul class="text"><li>
		Начинают с самого  правого  байта  числа  в  <b>ASCII</b>-формате
		и обрабатывают справа налево.</li><li>
	Удаляют тройки из левых шестнадцатеричных цифр каждого <b>ASCII</b>-байта.
	</li><li>
	Умножают <b>ASCII</b>-цифры на <b>1, 10, 100</b> (шест.<b>1, A, 64</b>) и
	т.д. </li><li>
    Cкладывают результаты</li></ul></p>
	
	<p class="text">
	<big>Для примера рассмотрим преобразование числа <b>1234</b> из  
	<b>ASCII</b>-формата в двоичный формат:</big><br>
	<center><table border="1" cellspacing="0" cellpadding="10" width="95%" class="text">
		<tr>
			<td></td>
			<td>Десятичное</td>
			<td>Шестнадцатиричное</td>
		</tr>
		<tr>
			<td>4 х 1 = </td>
			<td>4</td>
			<td>4</td>
		</tr>
		<tr>
			<td>3 х 10 = </td>
			<td>30</td>
			<td>1Е</td>
		</tr>
		<tr>
			<td>2 х 100 = </td>
			<td>200</td>
			<td>С8</td>
		</tr>
		<tr>
			<td>1 х 1000</td>
			<td>1000</td>
			<td>04D2</td>
		</tr>
		<tr>
			<td>Результат: </td>
			<td></td>
			<td>04D2</td>
		</tr>
	</table></center>
	</p>
	<p class="text">
	Действительно шест.<b>04D2</b> соответствует десятичному <b>1234</b>. 
	<br><br>
	<big><b><ins>Пример преобразования</ins>: </b></big>
	<table>
		<tr>
			<td width="333px"><code>CODESG SEGMENT<br>
			ASSUME CS:CODESG,DS:CODESG,SS:CODESG<br>
			ORG 100H <br>
			BEGIN: JMP SHORT MAIN</code></td>
			<td></td>
		</tr>
		<tr>
			<td><comment>; --------------------------------------------------------------------- </comment></td>
			<td></td>
		</tr>
		<tr>
			<td><code>ASCVAL DB	'1234'</code></td>
			<td><comment> ; Элементы данных</comment></td>
		</tr>
		<tr>
			<td><code>BINVAL DB	0<br>
			ASCLEN DB	4<br>
			MULT10 DB	1</code></td>
			<td></td>
		</tr>
		<tr>
			<td><comment>; --------------------------------------------------------------------- </comment></td>
			<td></td>
		</tr>
		<tr>
			<td><code>MAIN PROC NEAR</code></td>
			<td><comment> ; Основная процедура:</comment></td>
		</tr>
		<tr>
			<td><code>CALL B10ASBI</code></td>
			<td><comment> ; Вызвать преобразование ASCII </comment></td>
		</tr>
		<tr>
			<td><code>CALL C10BIAS</code></td>
			<td><comment> ; Вызвать преобразование двоичное </comment></td>
		</tr>
		<tr>
			<td><code>RET MAIN ENDP </code></td>
			<td></td>
		</tr>
		<tr>
			<td><comment>; --------------------------------------------------------------------- <br>	 
			; Преобразование ASCII в двоичное: 
			<br> ; --------------------------------------------------------------------- </comment></td>
			<td></td>
		</tr>
		<tr>
			<td><code>B10ASBI PROC<br>
			MOV	CX,10</code></td>
			<td><br><comment> ; Фактор умножения</comment></td>
		</tr>
		<tr>
			<td><code>LEA	SI,ASCVAL-1</code></td>
			<td><comment> ; Адрес ASCVAL </comment></td>
		</tr>
		<tr>
			<td><code>MOV	BX,ASCLEN</code></td>
			<td><comment> ; Длина ASCVAL</comment></td>
		</tr>
		<tr>
			<td><code>В20:<br>	
			MOV	AL,[SI+BX]</code></td>
			<td><br><comment>; Выбрать ASCII-символ </comment></td>
		</tr>
		<tr>
			<td><code>AND	AX,000FH</code></td>
			<td><comment>; Очистить зону тройки </comment></td>
		</tr>
		<tr>
			<td><code>MUL	MULT10</code></td>
			<td><comment>; Умножить на фактор 10  </comment></td>
		</tr>
		<tr>
			<td><code>ADD	BINVAL,AX</code></td>
			<td><comment>; Прибавить к двоичному </comment></td>
		</tr>
		<tr>
			<td><code>MOV	AX,MULT10</code></td>
			<td><comment>; Вычислить следующий </comment></td>
		</tr>
		<tr>
			<td><code>MUL	CX</code></td>
			<td><comment>; Фактор умножения</comment></td>
		</tr>
		<tr>
			<td><code>MOV	MULT10,AX<br>
			DEC	BX</code></td>
			<td><br> <comment>; Поспедн. ASCII-симвоп? </comment></td>
		</tr>
		<tr>
			<td><code>JNZ	B20</code></td>
			<td><comment>; Нет - продолжить </comment></td>
		</tr>
		<tr>
			<td><code>RET	<br>
			B10ASBI ENDP</code></td>
			<td></td>
		</tr>
	</table></p>
	<p class="text">
	В   процедуре   <b>B10ASBI</b>  выполняется  преобразование <b>ASCII</b>-числа
	<b>1234</b> в двоичный формат.  В примере предполагается,  что  длина
	<b>ASCII</b>-числа равна <b>4</b> и она записана в поле <b>ASCLEN</b>. 
	Для инициализации адрес<b> ASCII</b>-поля <b>ASCVAL-1</b> заносится в регистр
	<b>SI</b>,  а  длина  -  в  регистр  <b>BX</b>.<br>
	Команда по метке <b>B20</b> пересылает <b>ASCII</b>-байт в регистр <b>AL</b>:
	<br><code> MOV  AL,[SI+BX]</code><br><br>
	Здесь используется адрес <b>ASCVAL-1</b> плюс содержимое  регистра  <b>BX  (4)</b>,
	т.е. получается адрес <b>ASCVAL+3</b> (самый правый байт поля <b>ASCVAL</b>).  В  каждом
	цикле содержимое регистра <b>BX</b> уменьшается на <b>1</b>, что приводит к обращению  к
	следующему слева байту.  Для данной адресации можно  использовать  регистр
	<b>BX</b>, но не <b>CX</b>, и, следовательно, нельзя применять команду  <b>LOOP</b>.  В  каждом
	цикле происходит также умножение поля <b>MULT10</b> на <b>10</b>, что дает в  результате
	множители <b>1,10,100 и  т.д</b>.  Такой  прием  применен  для  большей  ясности,
	однако, для большей производительности множитель можно хранить в  регистре
	<b>SI</b> или <b>DI</b>.	
	</p>
	
	<a name="toAsc"></a>
	<h2>ПРЕОБРАЗОВАНИЕ ДВОИЧНОГО ФОРМАТА В ASCII-ФОРМАТ.</h2>
	<p class="stress">	 </p> 
	<p class="text">
	Для того, чтобы напечатать или отобразить  на  экране pезультат  выполнения арифметических 
	операций, необходимо преобразовать его в  <b>ASCII</b>-формат.  Данная  операция включает  
	в  себя  процесс  обратный предыдущему.    Вместо    умножения используется деление  
	двоичного  числа  на  <b>10</b> (шест.<b>0A</b>) пока результат не будет меньше <b>10</b>.
	Остатки,  которые лежат в границах от <b>0 до  9</b>,  образуют число  в  </b>ASCII</b> формате. 
	В  качестве  примера  рассмотрим  преобразование шест.<b>4D2</b> обратно в десятичный формат:<br>
		<center><table border="1" cellspacing="0" cellpadding="10" width="95%" class="text">
		<tr>
			<td></td>
			<td>Частное</td>
			<td>Остаток</td>
		</tr>
		<tr>
			<td>4D2 : A = </td>
			<td>7B</td>
			<td>4</td>
		</tr>
		<tr>
			<td>7B :  A = </td>
			<td>C</td>
			<td>3</td>
		</tr>
		<tr>
			<td>C :   A  = </td>
			<td>1</td>
			<td>2</td>
		</tr>
	</table></center></p><p class="text">
	Так как последнее частное <b>1</b> меньше, чем  шест.<b>A</b>,  то  операция
	завершена. Остатки вместе с последним частным  образуют  результат  в  
	<b>ASCII</b>-формате, записываемый справа налево <b>1234</b>. Все остатки и  
	последнее  частное  должны записываться в память с тройками, т.е. <b>31323334</b>.
	<br><br><big><b><ins>Пример преобразования</ins>: </b></big>
	<table>
	<tbody>
		<tr>
			<td width ="333px"><code>C10BIAS PROC<br>
			MOV     CX,0010</code></td>
			<td><br><comment>; Фактор деления </comment></td>
		</tr>
		<tr>
			<td><code>LEA     SI,ASCVAL+3 </code></td>
			<td><comment>; Адрес ASCVAL </comment></td>
		</tr>
		<tr>
			<td><code>  MOV     AX,BINVAL   </code></td>
			<td><comment>; Загрузить дв. число </comment></td>
		</tr>
		<tr>
			<td><code>С20:<br>
			CMP     AХ,0010   </code></td>
			<td><br><comment>; Значение меньше  10? </comment></td>
		</tr>
		<tr>
			<td><code> JB         С30    </code></td>
			<td><comment>; Да - выйти </comment></td>
		</tr>
		<tr>
			<td><code> XOR     DX,DX </code></td>
			<td><comment>; Очистить часть частного </comment></td>
		</tr>
		<tr>
			<td><code>  DIV       CX       </code></td>
			<td><comment>; Разделить на 10 </comment></td>
		</tr>
		<tr>
			<td><code>OR        DL,30H<br>
			MOV     [SI],DL </code></td>
			<td><br><comment>; Записать ASCII-символ </comment></td>
		</tr>
		<tr>
			<td><code>  DEC     SI<br>
			JMP     С20<br>
			C30:<br>
			OR       AL,30H    </code></td>
			<td><br><br><br><comment>; 3аписать поcл. частное </comment></td>
		</tr>
		<tr>
			<td><code> MOV     [SI],AL    </code></td>
			<td><comment>; как ASCII-символ </comment></td>
		</tr>
		<tr>
			<td><code>RET<br>
			C10BIAS ENDP<br><br>
			CODESG  ENDS<br>
			END    BEGIN</code></td>
			<td></td>
		</tr>
	</table></p>
	<p class="text">
	Процедура  <b>C10BIAS</b>   преобразует   шест.<b>4D2</b>   (результат вычисления
	в процедуре <b>B10ASBI</b>) в <b>ASCII</b>-число <b>1234</b>. 
	</p>
	
	<p class="stress">	 </p> 
	<center><b><a class="orange" href="l3.html">Лабораторная работа №3</a></b></center>
 <!-- страничка -- END -->
   </div></div></div>
 
      <div id="basement"><div id="basement-content">
         <div id="basement_text">
            <br>Программирование на Машинно-Ориентированных Языках.<br>
			Преподаватель: Коробов С.А.<br><br>
      </div>
	  <a class="home2" href="../index.html"><img title="На главную" src="content/home.png"></a>
	  <a class="book" href="themes_3.html"><img title="К оглавлению" src="content/book.png"></a>
	  </div>
	  <a class="min1" href="t91.html"><img title="Предыдущая тема" src="content/left.png"></a>
	  <a class="max1" href="t10-2.html"><img title="Следующая тема" src="content/right.png"></a>
	  </div>
</body>
 </html>
